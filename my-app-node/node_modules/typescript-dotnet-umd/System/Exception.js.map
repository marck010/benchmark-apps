{"version":3,"sources":["System/Exception.js","System/Exception.ts"],"names":["factory","module","exports","v","require","undefined","define","amd","Object","defineProperty","value","NAME","Exception","message","innerException","beforeSealing","this","_","name","getName","data","stack","eval","replace","toStringWithoutBrackets","ex","freeze","prototype","toString","m","dispose","k","hasOwnProperty"],"mappings":";;;;;CAKA,SAAWA,GACP,GAAsB,gBAAXC,SAAiD,gBAAnBA,QAAOC,QAAsB,CAClE,GAAIC,GAAIH,EAAQI,QAASF,QACfG,UAANF,IAAiBF,OAAOC,QAAUC,OAEf,kBAAXG,SAAyBA,OAAOC,KAC5CD,QAAQ,UAAW,WAAYN,IAEpC,SAAUI,QAASF,SAClB,YACAM,QAAOC,eAAeP,QAAS,cAAgBQ,OAAO,GCP1D,IAAMC,MAAc,YAWpBC,UAAA,WAgBC,QAAAA,WACUC,QACTC,eACAC,eAFSC,KAAAH,QAAAA,OAIT,IAAMI,GAAID,IAEVA,MAAKE,KAAOD,EAAEE,UACdH,KAAKI,QAEFN,iBACFG,EAAEG,KAAqB,eAAIN,gBAOzBC,eAAeA,cAAcE,EAGhC,KAEC,GAAII,OAAeC,KAAK,eAAeD,KACvCA,OAAQA,OACJA,MACDE,QAAQ,WAAY,IACpBA,QAAQ,qBAAsB,KAC7B,GAEJP,KAAKK,MAAQJ,EAAEO,0BAA4BH,MAE5C,MAAMI,KAGNjB,OAAOkB,OAAOT,GAsChB,MA9BWL,WAAAe,UAAAR,QAAV,WACE,MAAOR,OAKTC,UAAAe,UAAAC,SAAA,WAEC,MAAO,IAAIZ,KAAKQ,0BAAyB,KAGhCZ,UAAAe,UAAAH,wBAAV,WAEC,GAAMP,GAAID,KACJa,EAAIZ,EAAEJ,OACZ,OAAOI,GAAEC,MAAQW,EAAK,KAAOA,EAAK,KAMnCjB,UAAAe,UAAAG,QAAA,WAEC,GAAMV,GAAOJ,KAAKI,IAClB,KAAI,GAAIW,KAAKX,GAETA,EAAKY,eAAeD,UACfX,GAAKW,IAGhBnB,YAzFaV,SAAAU,UAAAA,UA2FbV,QAAAA,WAAeU","file":"Exception.js","sourcesContent":["/*!\n * @author electricessence / https://github.com/electricessence/\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\n * Based upon: https://msdn.microsoft.com/en-us/library/System.Exception%28v=vs.110%29.aspx\n */\n(function (factory) {\n    if (typeof module === \"object\" && typeof module.exports === \"object\") {\n        var v = factory(require, exports);\n        if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === \"function\" && define.amd) {\n        define([\"require\", \"exports\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    var NAME = 'Exception';\n    /**\n     * Represents errors that occur during application execution.\n     */\n    var Exception = /** @class */ (function () {\n        /**\n         * Initializes a new instance of the Exception class with a specified error message and optionally a reference to the inner exception that is the cause of this exception.\n         * @param message\n         * @param innerException\n         * @param beforeSealing This delegate is used to allow actions to occur just before this constructor finishes.  Since some compilers do not allow the use of 'this' before super.\n         */\n        function Exception(message, innerException, beforeSealing) {\n            this.message = message;\n            var _ = this;\n            this.name = _.getName();\n            this.data = {};\n            if (innerException)\n                _.data['innerException'] = innerException;\n            /* Originally intended to use 'get' accessors for properties,\n             * But debuggers don't display these readily yet.\n             * Object.freeze has to be used carefully, but will prevent overriding values at runtime.\n             */\n            if (beforeSealing)\n                beforeSealing(_);\n            // Node has a .stack, let's use it...\n            try {\n                var stack = eval(\"new Error()\").stack;\n                stack = stack\n                    && stack\n                        .replace(/^Error\\n/, '')\n                        .replace(/(.|\\n)+\\s+at new.+/, '')\n                    || '';\n                this.stack = _.toStringWithoutBrackets() + stack;\n            }\n            catch (ex) { }\n            Object.freeze(_);\n        }\n        /**\n         * A string representation of the error type.\n         * The default is 'Error'.\n         */\n        Exception.prototype.getName = function () { return NAME; };\n        /**\n         * The string representation of the Exception instance.\n         */\n        Exception.prototype.toString = function () {\n            return \"[\" + this.toStringWithoutBrackets() + \"]\";\n        };\n        Exception.prototype.toStringWithoutBrackets = function () {\n            var _ = this;\n            var m = _.message;\n            return _.name + (m ? (': ' + m) : '');\n        };\n        /**\n         * Clears the data object.\n         */\n        Exception.prototype.dispose = function () {\n            var data = this.data;\n            for (var k in data) {\n                if (data.hasOwnProperty(k))\n                    delete data[k];\n            }\n        };\n        return Exception;\n    }());\n    exports.Exception = Exception;\n    exports.default = Exception;\n});\n","/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n * Based upon: https://msdn.microsoft.com/en-us/library/System.Exception%28v=vs.110%29.aspx\r\n */\r\n\r\nimport {IDisposable} from \"./Disposable/IDisposable\";\r\nimport {IMap} from \"../IMap\";\r\nconst NAME:string = 'Exception';\r\n\r\n// Avoid importing node reference..\r\nexport interface Error {\r\n\tname: string;\r\n\tmessage: string;\r\n}\r\n\r\n/**\r\n * Represents errors that occur during application execution.\r\n */\r\nexport class Exception implements Error, IDisposable\r\n{\r\n\t/**\r\n\t * A string representation of the error type.\r\n\t * The default is 'Error'.\r\n\t */\r\n\treadonly name:string;\r\n\treadonly stack:string;\r\n\treadonly data:IMap<any>;\r\n\r\n\t/**\r\n\t * Initializes a new instance of the Exception class with a specified error message and optionally a reference to the inner exception that is the cause of this exception.\r\n\t * @param message\r\n\t * @param innerException\r\n\t * @param beforeSealing This delegate is used to allow actions to occur just before this constructor finishes.  Since some compilers do not allow the use of 'this' before super.\r\n\t */\r\n\tconstructor(\r\n\t\treadonly message:string,\r\n\t\tinnerException?:Error,\r\n\t\tbeforeSealing?:(ex:any)=>void)\r\n\t{\r\n\t\tconst _ = this;\r\n\r\n\t\tthis.name = _.getName();\r\n\t\tthis.data = {};\r\n\r\n\t\tif(innerException)\r\n\t\t\t_.data['innerException'] = innerException;\r\n\r\n\t\t/* Originally intended to use 'get' accessors for properties,\r\n\t\t * But debuggers don't display these readily yet.\r\n\t\t * Object.freeze has to be used carefully, but will prevent overriding values at runtime.\r\n\t\t */\r\n\r\n\t\tif(beforeSealing) beforeSealing(_);\r\n\r\n\t\t// Node has a .stack, let's use it...\r\n\t\ttry\r\n\t\t{\r\n\t\t\tlet stack:string = eval(\"new Error()\").stack;\r\n\t\t\tstack = stack\r\n\t\t\t\t&& stack\r\n\t\t\t\t\t.replace(/^Error\\n/, '')\r\n\t\t\t\t\t.replace(/(.|\\n)+\\s+at new.+/, '')\r\n\t\t\t\t|| '';\r\n\r\n\t\t\tthis.stack = _.toStringWithoutBrackets() + stack;\r\n\t\t}\r\n\t\tcatch(ex)\r\n\t\t{}\r\n\r\n\t\tObject.freeze(_);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * A string representation of the error type.\r\n\t * The default is 'Error'.\r\n\t */\r\n\tprotected getName():string\r\n\t{ return NAME; }\r\n\r\n\t/**\r\n\t * The string representation of the Exception instance.\r\n\t */\r\n\ttoString():string\r\n\t{\r\n\t\treturn `[${this.toStringWithoutBrackets()}]`;\r\n\t}\r\n\r\n\tprotected toStringWithoutBrackets():string\r\n\t{\r\n\t\tconst _ = this;\r\n\t\tconst m = _.message;\r\n\t\treturn _.name + (m ? (': ' + m) : '');\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the data object.\r\n\t */\r\n\tdispose():void\r\n\t{\r\n\t\tconst data = this.data;\r\n\t\tfor(let k in data)\r\n\t\t{\r\n\t\t\tif(data.hasOwnProperty(k))\r\n\t\t\t\tdelete data[k];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default Exception;\r\n"]}