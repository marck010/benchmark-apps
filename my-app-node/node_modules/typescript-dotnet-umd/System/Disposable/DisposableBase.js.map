{"version":3,"sources":["System/Disposable/DisposableBase.js","System/Disposable/DisposableBase.ts"],"names":["factory","module","exports","v","require","undefined","define","amd","Object","defineProperty","value","ObjectDisposedException_1","DisposableBase","__finalizer","this","__wasDisposed","prototype","get","enumerable","configurable","throwIfDisposed","message","objectName","_disposableObjectName","ObjectDisposedException","dispose","_","_onDispose"],"mappings":";;;;CAIA,SAAWA,GACP,GAAsB,gBAAXC,SAAiD,gBAAnBA,QAAOC,QAAsB,CAClE,GAAIC,GAAIH,EAAQI,QAASF,QACfG,UAANF,IAAiBF,OAAOC,QAAUC,OAEf,kBAAXG,SAAyBA,OAAOC,KAC5CD,QAAQ,UAAW,UAAW,6BAA8BN,IAEjE,SAAUI,EAASF,GAClB,YACAM,QAAOC,eAAeP,EAAS,cAAgBQ,OAAO,GCT1D,IAAAC,GAAAP,EAAA,6BAIAQ,EAAA,WAGC,QAAAA,GAA6BC,GAAAC,KAAAD,YAAAA,EAIrBC,KAAAC,eAAwB,EA8CjC,MA5CCP,QAAAC,eAAIG,EAAAI,UAAA,eDIOC,ICJX,WAEC,MAAOH,MAAKC,eDKFG,YAAY,EACZC,cAAc,ICAfP,EAAAI,UAAAI,gBAAV,SACCC,EACAC,GAEA,GAFA,SAAAA,IAAAA,EAAoBR,KAAKS,uBAEtBT,KAAKC,cACP,KAAM,IAAIJ,GAAAa,wBAAwBF,EAAYD,EAC/C,QAAO,GAIRT,EAAAI,UAAAS,QAAA,WAEC,GAAMC,GAAIZ,IACV,KAAIY,EAAEX,cACN,CAGCW,EAAEX,eAAgB,CAClB,KAECW,EAAEC,aDHU,QCOTD,EAAEb,cAEJa,EAAEb,cACIa,EAAGb,YAAc,WAOjBD,EAAAI,UAAAW,WAAV,aAEDf,IArDsBV,GAAAU,eAAAA,EAuDtBV,EAAAA,WAAeU","file":"DisposableBase.js","sourcesContent":["/*!\n * @author electricessence / https://github.com/electricessence/\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\n */\n(function (factory) {\n    if (typeof module === \"object\" && typeof module.exports === \"object\") {\n        var v = factory(require, exports);\n        if (v !== undefined) module.exports = v;\n    }\n    else if (typeof define === \"function\" && define.amd) {\n        define([\"require\", \"exports\", \"./ObjectDisposedException\"], factory);\n    }\n})(function (require, exports) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    var ObjectDisposedException_1 = require(\"./ObjectDisposedException\");\n    var DisposableBase = /** @class */ (function () {\n        function DisposableBase(__finalizer) {\n            this.__finalizer = __finalizer;\n            this.__wasDisposed = false;\n        }\n        Object.defineProperty(DisposableBase.prototype, \"wasDisposed\", {\n            get: function () {\n                return this.__wasDisposed;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        DisposableBase.prototype.throwIfDisposed = function (message, objectName) {\n            if (objectName === void 0) { objectName = this._disposableObjectName; }\n            if (this.__wasDisposed)\n                throw new ObjectDisposedException_1.ObjectDisposedException(objectName, message);\n            return true;\n        };\n        DisposableBase.prototype.dispose = function () {\n            var _ = this;\n            if (!_.__wasDisposed) {\n                // Preemptively set wasDisposed in order to prevent repeated disposing.\n                // NOTE: in true multi-threaded scenarios, this needs to be synchronized.\n                _.__wasDisposed = true;\n                try {\n                    _._onDispose(); // Protected override.\n                }\n                finally {\n                    if (_.__finalizer) {\n                        _.__finalizer();\n                        _.__finalizer = void 0;\n                    }\n                }\n            }\n        };\n        // Placeholder for overrides.\n        DisposableBase.prototype._onDispose = function () { };\n        return DisposableBase;\n    }());\n    exports.DisposableBase = DisposableBase;\n    exports.default = DisposableBase;\n});\n","/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n */\r\n\r\nimport {ObjectDisposedException} from \"./ObjectDisposedException\";\r\nimport {IDisposableAware} from \"./IDisposableAware\";\r\nimport {Closure} from \"../FunctionTypes\";\r\n\r\nexport abstract class DisposableBase implements IDisposableAware\r\n{\r\n\r\n\tconstructor(private readonly __finalizer?:Closure|null)\r\n\t{\r\n\t}\r\n\r\n\tprivate __wasDisposed:boolean = false;\r\n\r\n\tget wasDisposed():boolean\r\n\t{\r\n\t\treturn this.__wasDisposed;\r\n\t}\r\n\r\n\t// Allow for simple override of name.\r\n\tprotected _disposableObjectName:string;\r\n\r\n\tprotected throwIfDisposed(\r\n\t\tmessage?:string,\r\n\t\tobjectName:string = this._disposableObjectName):true|never\r\n\t{\r\n\t\tif(this.__wasDisposed)\r\n\t\t\tthrow new ObjectDisposedException(objectName, message);\r\n\t\treturn true;\r\n\t}\r\n\r\n\r\n\tdispose():void\r\n\t{\r\n\t\tconst _ = this;\r\n\t\tif(!_.__wasDisposed)\r\n\t\t{\r\n\t\t\t// Preemptively set wasDisposed in order to prevent repeated disposing.\r\n\t\t\t// NOTE: in true multi-threaded scenarios, this needs to be synchronized.\r\n\t\t\t_.__wasDisposed = true;\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\t_._onDispose(); // Protected override.\r\n\t\t\t}\r\n\t\t\tfinally\r\n\t\t\t{\r\n\t\t\t\tif(_.__finalizer) // Private finalizer...\r\n\t\t\t\t{\r\n\t\t\t\t\t_.__finalizer();\r\n\t\t\t\t\t(<any>_).__finalizer = void 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Placeholder for overrides.\r\n\tprotected _onDispose():void { }\r\n\r\n}\r\n\r\nexport default DisposableBase;"]}